import time
from task_engine import *


def main():
    print("============= 自动刷积分任务启动 =============")

    # ------------------------------------------
    # 1. 点击 “我的”
    # ------------------------------------------
    click_template("templates/mine_btn.png", "我的")

    # ------------------------------------------
    # 2. 点击 “积分任务”
    # ------------------------------------------
    click_template("templates/point_task_btn.png", "积分任务")

    time.sleep(2)

    # ------------------------------------------
    # 3. 扫描任务列表：找 “未完成”
    # ------------------------------------------
    for _ in range(8):   # 最多翻 8 页任务
        print("\n=== 扫描任务列表 ===")

        pos = find_text(["未完成"])
        if pos:
            click(*pos)
            time.sleep(2)

            # -------------------------
            # 根据不同任务执行逻辑
            # -------------------------
            # 假设：当前是【看视频任务】
            do_video_task(times=10)

            # 返回继续查找
            click_template("templates/point_task_btn.png", "返回积分任务")

        else:
            # 没找到未完成，往下滑继续找
            print("未找到未完成 → 下滑继续找")
            scroll_down(1000)

    print("\n============= 所有任务扫描完毕 =============")


if __name__ == '__main__':
    main()
